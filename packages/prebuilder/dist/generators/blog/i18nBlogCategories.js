"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const ts_morph_1 = require("ts-morph");
const config_1 = require("../../config");
const emptyString = '';
const PREFIXED_I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS = config_1.I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS.map((field) => config_1.I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS_PREFIX + field);
function generateSchema(blogArchitecture, __PREFIXED_I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS, __I18N_SUBCATEGORIES_REQUIRED_EXTRA_FIELDS) {
    const schema = {};
    for (const category in blogArchitecture) {
        const subcategories = blogArchitecture[category];
        schema[category] = {};
        for (const extraField of __PREFIXED_I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS) {
            schema[category][extraField] = emptyString;
        }
        Object.keys(subcategories).forEach((subcategory) => {
            if (__I18N_SUBCATEGORIES_REQUIRED_EXTRA_FIELDS.length <= 0) {
                schema[category][subcategory] = emptyString;
                return;
            }
            const obj = {};
            for (const extraField of __I18N_SUBCATEGORIES_REQUIRED_EXTRA_FIELDS) {
                obj[extraField] = emptyString;
            }
            schema[category][subcategory] = obj;
        });
    }
    return schema;
}
function generateTrailingTrivia(__PREFIXED_I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS, __I18N_SUBCATEGORIES_REQUIRED_EXTRA_FIELDS) {
    const CategoriesMetadatasBaseProps = 'Record<string, SubcategoriesMetadatas>';
    const CategoriesMetadatas = 'type CategoriesMetadatas =' +
        ' ' +
        (__PREFIXED_I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS.length > 0
            ? [
                `Record<${__PREFIXED_I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS.map((field) => `'${field}'`).join(' | ')}, EmptyString>`,
                CategoriesMetadatasBaseProps
            ].join(' | ')
            : CategoriesMetadatasBaseProps);
    const SubcategoriesMetadatas = 'type SubcategoriesMetadatas =' +
        ' ' +
        (__I18N_SUBCATEGORIES_REQUIRED_EXTRA_FIELDS.length > 0
            ? `Record<${__I18N_SUBCATEGORIES_REQUIRED_EXTRA_FIELDS.map((field) => `'${field}'`).join(' | ')}, EmptyString>`
            : 'EmptyString');
    return [
        "type EmptyString = '';",
        `${SubcategoriesMetadatas};`,
        `${CategoriesMetadatas};`,
        'type BlogCategoriesArtifact = Record<string, CategoriesMetadatas>'
    ].join('\n');
}
function generateI18nBlogCategories(blogArchitecture, __BLOG_CATEGORIES_CONST_STR = config_1.BLOG_CATEGORIES_CONST_STR, __TARGET_FOLDER = config_1.GENERATIONS_TARGET_FOLDER, __PREFIXED_I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS = PREFIXED_I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS, __I18N_SUBCATEGORIES_REQUIRED_EXTRA_FIELDS = config_1.I18N_SUBCATEGORIES_REQUIRED_EXTRA_FIELDS) {
    const project = new ts_morph_1.Project();
    const initializerWriterFunction = ts_morph_1.Writers.assertion(JSON.stringify(generateSchema(blogArchitecture, __PREFIXED_I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS, __I18N_SUBCATEGORIES_REQUIRED_EXTRA_FIELDS), null, 2).replace(/""|''|``/g, '_'), 'const satisfies BlogCategoriesArtifact;\n');
    const sourceFile = project.createSourceFile(`${__TARGET_FOLDER}/${__BLOG_CATEGORIES_CONST_STR}.ts`, {
        statements: [
            {
                declarations: [
                    {
                        type: 'EmptyString',
                        initializer: "''",
                        name: '_'
                    }
                ],
                declarationKind: ts_morph_1.VariableDeclarationKind.Const,
                kind: ts_morph_1.StructureKind.VariableStatement
            },
            {
                declarations: [
                    {
                        trailingTrivia: generateTrailingTrivia(__PREFIXED_I18N_CATEGORIES_REQUIRED_EXTRA_FIELDS, __I18N_SUBCATEGORIES_REQUIRED_EXTRA_FIELDS),
                        initializer: initializerWriterFunction,
                        name: __BLOG_CATEGORIES_CONST_STR
                    }
                ],
                declarationKind: ts_morph_1.VariableDeclarationKind.Const,
                kind: ts_morph_1.StructureKind.VariableStatement,
                isExported: false
            }
        ]
    }, { overwrite: true });
    const oldTextLength = sourceFile.getText().length;
    sourceFile.insertText(0, config_1.AUTOGENERATED_CODE_COMMENT_STR);
    sourceFile.insertText(oldTextLength + config_1.AUTOGENERATED_CODE_COMMENT_STR.length, `export default ${__BLOG_CATEGORIES_CONST_STR};`);
    sourceFile.formatText(config_1.TS_MORPH_FORMATTER_SETTINGS);
    sourceFile.saveSync();
}
exports.default = generateI18nBlogCategories;
